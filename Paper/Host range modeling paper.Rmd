---
title: "Host Range Paper"
author: "Ave Bisesi"
date: "`r Sys.Date()`"
output: pdf_document
tables: true
header-includes:
- \usepackage{caption}
- \usepackage{wrapfig}
- \captionsetup{labelfont=bf, font=footnotesize}
- \captionsetup[figure]{font=footnotesize,labelfont=bf}
- \setlength{\footnotesep}{0.5cm}
- \NewExpandableDocumentCommand\mcc{m}{\multicolumn{1}{c}{#1}}
- \usepackage[utf8]{inputenc}
- \usepackage{amsmath}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("deSolve")
library("reshape2")
library("patchwork")
library("ggthemes")
library("phaseR")
```

## **Abstract**

## **Introduction**

Predators often impose top-down control of the ecosystems in which they're found, impacting species abundances and community structure and function [citation]. For example, in marine environments, lytic bacteriophages (phages), the viral predators of bacteria, are particularly critical drivers of microbial populations, killing up to 40% of phytoplankton biomass per day [citation]. The diet breadth of predators - how many different prey resources they can utilize - is therefore an important predictor of how top-down control shapes a given community [Bohannon 1998]. However, organisms differ broadly in their diet breadths, ranging from true specialists (able to prey on a single species) to true generalists (able to utilize any prey species available) [Forister and Jenkins; Sax 2017]. Theoretically, an expanded prey range provides many advantages for predators, including increased prey availability and reduced foraging time [Guyader and Burch 2008]. Additionally, while specialization is undoubtedly ecologically beneficial in some contexts, it can also increase the probability of extinction in others [Dennis et al 2011]. Despite these detriments, specialization is widespread in nature. In particular, phages are often highly specialized to single bacterial strains or even single serovars, explaining much of the optimism regarding highly-targeted phage therapy in controlling antibiotic resistant microbes [citations]. But what drives the prevalence of specialization, in phage and across predator species, when the benefits of generalism are numerous, and what factors are most important in shaping evolutionary shifts in diet breadth? 

One factor well-known to influence evolutionary dynamics at higher trophic levels is the structure of prey communities and the relative availability of possible prey [Gause 1934; Via 1990; Kwecki 1998; Kassen 2002; Duffy and Turner 2009]. After all, if a prey species is rare or randomly lost from a community, there will necessarily be strong selection to exploit a more abundant one [Okamoto 2019]. Because competition between prey tends to generate anti-correlated frequency and positive interactions, particularly obligate mutualisms, tend to generate correlated frequency, the sign and outcome of interactions between prey are likely to significantly change the relative availability of prey for predators and thus alter the strength and direction of selection on predator diet breadth. Indeed, previous modeling has demonstrated that increasing nutrient availability among competing plants can select for generalist herbivores, even when the evolution of generalism is significantly restricted by genetic constraints [Velzen and Etienne 2012]. Mathematical models additionally suggest that when prey are unequal competitors, it is more difficult for generalist genotypes to arise and persist in the predator population [Okamoto 2019]. Less is known theoretically and empirically about how positive interactions like obligate mutualism shape evolution at higher trophic levels, although, intuitively, the interdependence between prey species may increase the likelihood of overexploitation by predators and subsequent system collapse. 

Prey interactions and relative abundance are not the only force structuring prey communities and likely driving the evolution of predator diet breadth. For example, in pathogens, high between-host transmission, driven by the spatial arrangement, abundances, and contact structure between different host types, selects for more generalists [Visher and Boots 2020]. Experimental evolution has also validated the expectation that environmental heterogeneity, whether as a function of multiple available resources or temporal resource fluctuation, can be sufficient to maintain generalism [Sant et al 2021; McLeish 2017; Wilson and Yoshimura 1994]. Even when environmental heterogeneity is minimized to two potential prey resources, optimal foraging theory suggests that absolute resource density is a strong predictor of diet breadth, such that specialization is beneficial when prey density is high and generalism is beneficial when prey density is low because it increases predator competition for prey and elongates search times [Burch 2008; Bono 2013, 2015]. Finally, optimal foraging theory predicts an important trade-off in the face of prey abundances: the opportunity cost of spending time searching for and attacking a poor quality host [Heineman; probably another host quality paper]. If hosts of high quality are abundant, then specialization will be beneficial; conversely, even as the differences in host quality increase, if all hosts are rare, predators should experience selection to maintain an expanded diet breadth [Heineman]. The various forces structuring prey communities - interactions between them, alpha diversity and stochastic extinction, absolute abundance, quality differences, and spatial distribution - are thus important parameters when considering bottom-up control of the evolution of predator diet breadth. 

Trade-off theory provides additional expectations regarding the evolution of diet breadth that are largely independent of the structure of prey communities. In this case, the predominance of specialization is generally attributed to evolutionary trade-offs and antagonistic pleiotropy, wherein a fitness cost dictates that an organism can be a "jack of all trades, but master of none" [MacArthur 1972, Agrawal et al 2010]. If trade-offs are common, then the evolution of specialization should be widespread, while generalism is likely only to persist in particular cases, such as when resources fluctuate in availability [Wilson and Yoshimura, 1994; McLeish 2017; Forister and Jenkins]. The jack of all trades hypothesis predicts performance trade-offs for expanded resource use should exist both within and between species [Futuyma and Moreno 1988; Scriber 2019; Forister and Jenkins]. However, trade-offs for generalism are not universally observed, potentially limiting the explanatory power of the hypothesis [Fry 1996; Agrawal 2000; Hereford 2009; Visher and Boots 2020; Forister and Jenkins; Bono 2013]. In some cases, mutation accumulation may actually mask costs if the mutations underpinning broadened diet breadth are neutral in the environment in which they are selected but deleterious in alternative environments [Kassen 2002]. Similarly, if the fitness of a specialist population is far from a fitness peak, any mutations, including those enabling expanded diet breadth, are likely to drive increases in fitness [Kassen 2002; Visher and Boots 2020]. While a fitness cost of generalism is typically not sufficient to explain selection on diet breadth in every community, it is likely to play some role, in combination with the relative and absolute abundances of prey species. 

As such, we use both optimal foraging theory and trade-off theory to generate a number of relevant hypotheses regarding the evolution of predator diet breadth as a consequence of ecological interactions. Theory on resource competition demonstrates that, if two resources are nutritionally identical, specialization on a single food source is optimal when eating one resource reduces the availability of the other resource [Tilman 1982]. This is analogous to a situation in which nutritionally identical prey types are obligately mutualistic, as consumption of one prey species should suppress the entire community. In contrast, when consumption of one resource increases the availability of the other, a mixed diet will be optimal [Tilman 1982]. This prediction is similar to a scenario in which a predator is consuming competing prey, as eating one prey species will increase the abundance of the other through competitive release (making prey abundances anti-correlated). While these predictions are fundamentally ecological, sustained ecological favorability of one genotype over another leads to evolutionary shifts, thus we expect that these predictions will be robust on evolutionary timescales. Importantly, if a trade-off for generalism is present, the strength of antagonistic pleiotropy may offset the relative importance of prey ecology in shaping selection [Egas et al]. However, although resource competition theory assumes that resources are nutritionally identical, we expect that differences in prey quality should not qualitatively alter our hypotheses. Obligate mutualisms will stabilize the presence of a higher-quality host, so, as host quality differences are amplified, specialization should be favored more strongly. If interspecific competition reduces availability of the higher quality host, that will favor generalism; if it increases the availability of the higher quality host, that will provide a selective advantage for specialization. 

These hypotheses are particularly relevant for applications in microbial contexts, where bacterial prey have been repeatedly shown to structure phage predator communities and selection on them [Chen et all 2011; MacDonald; Bohannon]. Importantly, in microbial communities, phage predators are likely to encounter a diversity of interacting prey species, from cooperative interactions where metabolites are exchanges or a public good is produced [Black Queen; Harcombe 2010; Cavaliere et al 2017], to bacterial species competing through resource exploitation or toxin production [Foster 2012; a couple others]. Understanding phage diet breadth thus requires insight into how bacterial interactions shape phage evolution, with consequences for successful management of antibiotic resistant bacterial infections and ship biofouling, to name a few [citations]. 

To test our hypotheses, we use a Lotka-Volterra model of a cross-feeding microbial system and lytic phages with variable specificity to investigate how interactions between prey species, antagonistic pleiotropy among predator diet breath strategies, absolute prey abundance, and differences in prey quality govern selective dynamics on predator diet breadth. Our model expands previous theoretical approaches by considering positive interactions between prey species and [whatever else we do]. Here we find that obligately mutualistic interactions between prey are more likely to select for predator specialization, while competition between prey is more likely to select for predator generalism. Additionally, we propose a simple rule for predicting the necessary fitness trade-off to select for generalism or specialism and show that difference in prey quality for a generalist predator shift our predictions quantitatively but not qualitatively.

## **Methods**

### **Model Description**

We model two prey species either competing for a common resource or obligately dependent upon one another within a given habitat. In the absence of predators, we assume that prey interactions follow Lotka-Volterra dynamics: we define $\mu_\mathrm{i}$ as the intrinsic rate of growth of each prey species *i* and $\delta_\mathrm{i}$  as the natural death rate of prey species *i*. 

When prey are cooperating, the upper bound of species abundances are defined by Monod kinetics and intraspecific competition, where $\kappa_\mathrm{i}$ is the species-specific Monod constant for prey *i* and R is the carrying capacity of the entire system. Cooperative interactions are additionally mediated by a coefficient for relative mutualistic benefit, $\alpha_\mathrm{j,i}$, where the value reflects the beneficial effect of prey species *i* on the per capita growth rate of prey species *j* and additionally prevents either prey species from existing without the other.

\begin{eqnarray} 
    \frac{dE}{dt} & = & \mu_e \times E \times \frac{\alpha_{e,s} \times S}{(\alpha_{e,s} \times S) + \kappa_e} \times (R - E) - (\zeta_{e,2} \times gen \times E) - (\delta_e \times E) \\
    \frac{dS}{dt} & = & \mu_s  \times S \times \frac{\alpha_{s,e} \times E}{(\alpha_{s,e} \times E) + \kappa_s} \times (R - S) - (\zeta_{s,1} \times sp \times S) - (\zeta_{s,2} \times gen \times S) - (\delta_s \times S) 
	\end{eqnarray}

When prey are competing, $\beta_\mathrm{j,i}$ is the competitive effect of prey species *i* on the per capita growth rate of prey species *j*. By default, competing prey are subject to a carrying capacity R, intraspecific competition, and competition coefficients such that the two prey species can always coexist in the absence of a predator. 

\begin{eqnarray} 
    \frac{dE}{dt} & = & \mu_e \times E \times (R - E - (\beta_{e,s} \times S)) - (\zeta_{e,2} \times gen \times E) - (\delta_e \times E) \\
    \frac{dS}{dt} & = & \mu_s  \times S \times (R - S - (\beta_{s,e} \times E)) - (\zeta_{s,1} \times sp \times S) - (\zeta_{s,2} \times gen \times S) - (\delta_s \times S)
	\end{eqnarray}

We then consider two additional species with an exponential model: a generalist predator that can consume both prey species present, and a specialist predator that can consume only one. Predator conversion efficiency and attack rate govern predator reproduction on prey species; generalist preference can be altered by changing the relative conversion efficiency or attack rate of the generalist predator on species *i* versus species *j*. Predators are also subject to natural death rates. The same natural death rate is imposed on all four species.

\begin{eqnarray} 
   \frac{dgen}{dt} & = & (\gamma_{s,2} \times \zeta_{s,2} \times gen \times S ) + (\gamma_{e,2} \times \zeta_{e,2} \times gen \times E) - (\delta_g \times gen) \\
    \frac{dsp}{dt} & = & (\gamma_{s,1} \times \zeta_{s,1} \times sp \times S ) - (\delta_p \times sp)
	\end{eqnarray}

\begin{table}[htb]

    \centering % instead of \begin{center}
    \caption{Model parameters, default values, and descriptions.}
    \vspace{1mm} % Adjust the height of the space between caption and tabular

\begin{tabular}{ p{2cm} p{2cm} p{11cm}  }
    \toprule
\mcc{Parameter}& \mcc{Default Value}& \mcc{Description}  \\
    \midrule
$\alpha_\mathrm{j,i}$ &  1.0 &   Cooperation coefficient, benefit of host species \textit{i} to host species \textit{j} \\
$\beta_\mathrm{j,i}$  &  0.9 &   Competition coefficient, effect of host species \textit{i} on host species \textit{j} \\
$\mu_\mathrm{i}$    &  0.5 &   Intrinsic growth rate of host species \textit{i} \\
$\gamma_\mathrm{i,x}$ &  20  &   Efficiency of predator with range \textit{x} on host species \textit{i} \\
$\zeta_\mathrm{i,x}$  &  0.001 &   Consumption rate of predator with range \textit{x} on host species \textit{i} \\
$\delta_\mathrm{i}$    &  0.03  &   Natural rate of death for species \textit{i} \\
$\kappa_\mathrm{i}$ &  1.0    &   Half-saturation Monod constant of species \textit{i} \\
R &  1.0 (coop) or 2.0 (comp) &   System carrying capacity \\
    \bottomrule
\end{tabular}

\end{table}

### **Model Analyses**

To compare how positive and negative interactions between prey affect selective pressure on predator host range, we first analytically solve for the zero net-growth isoclines of these equations, determining the relative ratio of the shared prey species required to favor one predator over the other. To contextualize our analytical findings, we then numerically solve for the equilibrium dynamics of the system using an initial density of $0.1$ for each species, tracking maximum biomass, coexistence, and relative fitness of the predators under four different scenarios: 1) imposing a trade-off for expanded prey range by penalizing the predator efficiency or attack rate of the generalist, 2) altering the intrinsic growth rates or interaction coefficients of the prey species and thus shifting the dynamics of prey coexistence, 3) imposing a trade-off for expanded prey range by altering the relative predator efficiency or consumption rate of the generalist on each prey species, or 4) altering the nutrient availability in the system by changing carrying capacity. 

In the first scenario, we start by exploring the behavior of the model when both predators are parametrically identical, before imposing a trade-off for generalism by sequentially improving the specialist predatorâ€™s conversion efficiency or attack rate. Next, we change the relative growth rates or interaction coefficients of the prey species such that coexistence at equilibrium, in the absence of predators, is either biased toward one prey species or no longer possible. We also compare differences in predator relative fitness and coexistence while both prey coexistence and benefit of specialism are changing. We then model a scenario in which the generalist predator displays preference for one of its two potential prey by biasing its conversion efficiency or attack rate on one prey and calculating relative fitness and coexistence dynamics of the specialist, showing results with and without a benefit of specialism. Lastly, we examine predator coexistence and relative fitness as the carrying capacity of the entire system is shifted from low to high.

\begin{table}[htb]

    \centering % instead of \begin{center}
    \caption{Parameter trade-offs tested in our model.}
    \vspace{1mm} % Adjust the height of the space between caption and tabular

\begin{tabular}{ p{4cm} p{4cm} p{7cm}  }
    \toprule
\mcc{Trade-off}& \mcc{Parameter Combinations}& \mcc{Significance}  \\
    \midrule
None &  $\gamma_\mathrm{i,2}=\gamma_\mathrm{i,1}$ and $\zeta_\mathrm{i,2}=\zeta_\mathrm{i,1}$ &   Generalist and specialist predators are parametrically identical \\
Benefit of specialism &  $\gamma_\mathrm{i,2}\neq\gamma_\mathrm{i,1}$ or $\zeta_\mathrm{i,2}\neq\zeta_\mathrm{i,1}$ &  Specialist and generalist predators differ in their ability to kill hosts \\
Interaction outcome & $\mu_\mathrm{i} \neq \mu_\mathrm{j}$ or $\beta_\mathrm{i,j} \neq \beta_\mathrm{j,i}$ or $\alpha_\mathrm{i,j} \neq \alpha_\mathrm{j,i}$  & Prey species coexistence in the absence of predators is biased or impossible \\
Generalist preference  &  $\gamma_\mathrm{i,2} \neq \gamma_\mathrm{j,2}$ or $\zeta_\mathrm{i,2} \neq \zeta_\mathrm{j,2}$ &   Generalist predators are better at killing one prey species than another \\
Carrying capacity &  0 < R < 5 &  Nutrient availability in the system is increased or reduced  \\
    \bottomrule
\end{tabular}

\end{table}

To quantify predator coexistence, we take the equilibrium abundance of both predators and impose an arbitrary cut-off consistent with the rounding error of the LSODA solver and the initial densities of the simulations: any predator with an equilibrium abundance below a threshold value of $0.001$ is considered extinct. Regions of coexistence, we examine the direction of selection in these simulated scenarios by calculating the relative fitness of the specialist predator genotype, where relative fitness is the reproductive rate ($\frac{density_\mathrm{eq} - density_\mathrm{init}}{density_\mathrm{init}}$) of the specialist divided by the reproductive rate of the generalist. Relative fitness values are normalized on a scale from 0 to 1 to accommodate reproductive rates of zero for either predator (which, through division, can lead to potential values ranging from 0 to infinity), with a value greater than 0.5 indicating that the specialist is more fit and a value below 0.5 indicating that the generalist is more fit. 

All simulations are run in R with the DeSolve package, using the LSODA solver with an absolute tolerance of $10^{-14}$. Fixed point analysis was completed in Mathematica 13.1.

## Results

### **Fundamental behavior of the model**

First we ask about the fundamental behavior of our model without predators, when only the two prey species are present. In this case, there are four fixed points for each interaction type, corresponding to a) total extinction, b) partial extinction of one prey species or c) the other, and d) coexistence. For cooperating prey species, coexistence depends on four parameters: the total available resources (*R*), the growth rates ($\mu_\mathrm{i}$ and $\mu_\mathrm{j}$), the saturation constants ($\kappa_\mathrm{i}$ and $\kappa_\mathrm{j}$), and the natural rate of death, which is, by default, the same for each species ($\delta_\mathrm{i}$). Due to the obligate nature of the modeled interaction, the relative benefit ($\alpha_\mathrm{i}$ and $\alpha_\mathrm{j}$) does not impact the possibility of coexistence, only the relative abundance of each species at equilibrium. In contrast, for competing prey species, coexistence depends on growth rates ($\mu_\mathrm{i}$ and $\mu_\mathrm{j}$), total available resources (*R*), natural rate of death ($\delta_\mathrm{i}$), and the competition coefficients ($\beta_\mathrm{i}$ and $\beta_\mathrm{j}$). As a result, competitive exclusion of one competing species or the other can be mediated either through changes to $\beta_\mathrm{i}$ or $\mu_\mathrm{i}$. However, the net-zero growth isoclines of competing species using our default parameters (*Table 1*) are consistent with coexistence, as each species limits its own growth more than it limits the growth of the other. Default parameters for mutualistic prey display predictable Lotka-Volterra behavior, such that species converge toward a stable, bounded equilibrium point at high density and are limited at low density by an Allee effect.

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig1.png"}
    \caption{Zero-net growth prey isoclines in the absence of predators.}
\end{figure}

Next we examine the fundamental behavior of the model when predators are present. Here, there are ten fixed points for each interaction type, corresponding to all possible combinations of coexistence ranging from total extinction to four-species coexistence. To examine cases in which we expect specialist predators to be ecologically favored, based on a four-species fixed point, we compare the equilibrium density of the shared prey species (*S*), $S^{*}$. Specialist predators will dominate in those domains in which the $S^{*}_{sp}$ value is lower than the $S^{*}_{gen}$,as is consistent with $R^{*}$ competition theory. Solving this inequality, we see that it is easy to satisfy in cases where the alternative prey source (*E*) is very rare or the conversion efficiency and/or attack rate of the specialist is higher than the equivalent parameter for the generalist. Fixed-point equilibrium analysis therefore predicts that, in the regions where both prey species are present, a parametric cost of generalism ($\zeta_\mathrm{i,2}$ or $\gamma_\mathrm{i,2}$) should be required to favor the specialist predator. However, the amount of alternative prey source (*E*) present will be influenced, in part, by the strength and outcome of interactions between prey.

Finally, when predators are present, fixed-point analysis indicates that altering cost of generalism as either attack rate or conversion efficiency will not impact coexistence dynamics differently, but, because changes in attack rate alter the speed of predation without changing the number of new progeny produced per prey consumed, there will be quantitative differences in relative fitness when cost is imposed as attack rate instead of conversion efficiency. In most scenarios, if the cost of generalism is modeled through attack rate, the relative fitness of the specialist will be reduced in comparison to the same analysis when cost of generalism is modeled through conversion efficiency.

\begin{eqnarray} 
   S^{*}_{gen} & = & \frac{\delta - \gamma_{g}\zeta_{g} E}{\gamma_{g} \zeta_{g}}  \\
   S^{*}_{sp} & = & \frac{\delta}{\gamma_{p}\zeta_{p}} \\
   S^{*}_{sp} & < & S^{*}_{gen} \\
    \frac{\delta}{\gamma_{p} \zeta_{p}} & < & \frac{\delta - \gamma_{g}\zeta_{g} E}{\gamma_{g} \zeta_{g}} \\
    \frac{\gamma_{g}\zeta_{g}}{\gamma_{p}\zeta_{p}} & < & 1 - \frac{\gamma_{g}\zeta_{g} E}{\delta}
\end{eqnarray}

### **A benefit of specialism is required to favor specialists when prey converge to an unbiased ratio**

To verify the accuracy of our $S^{*}$ analysis, which predicts that the specialist should dominate where the alternative prey source (*E*) is rare or there is a cost of generalism, we first use default parameters (*Table 1*) to examine the cost of generalism favoring the specialist predator when prey species converge to a $50:50$ ratio at equilibrium in the absence of predators (i.e. satisfy the inequality by directly changing $\frac{\gamma_{g}\zeta_{g}}{\gamma_{p} \zeta_{p}}$; *Table 2*). First we increase the conversion efficiency of the specialist while holding the attack rate constant. Fixed-point analysis indicates that, when prey species are cooperating, the four-species equilibrium point is stable in two domains - $0 < \gamma_{p} < \gamma_{g}$ and $2\gamma_{g} < \gamma_{p} < 2.83\gamma_{g}$ - and a saddle point everywhere else. When prey species are competing, the equilibrium point is stable when $0 < \gamma_{p} < \gamma_{g}$ and $\gamma_{p} > 2\gamma_{g}$ and a saddle point in the region where $\gamma_{g} < \gamma_{p} < 2\gamma_{g}$. Evaluating the equilibrium predator densities in these ranges, we find that, when prey are cooperating, the specialist predator is lost unless its conversion efficiency is at least twice as large as the generalist's; when its conversion efficiency is more than twice as large, the generalist is lost. Similarly, the specialist predator cannot be sustained on competing prey when its conversion efficiency is less than twice that of the generalist's, but, unlike in the case of cooperating prey, the specialist can coexist with the generalist but not exceed its equilibrium density.

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig2.png"}
    \caption{Equilibrium abundances of predators across different prey interactions as cost of generalism increases.}
\end{figure}

Changing the attack rate of the specialist instead of the conversion efficiency, we see the same effects when prey are cooperating: the four-species equilibrium is stable when $0 < \zeta_{p} < \zeta_{g}$ and $2\zeta_{g} < \zeta_{p} < 2.83\zeta_{g}$ and a saddle point elsewhere. Results diverge somewhat when prey are competing. Here, the four-species equilibrium point is again a saddle point when $\zeta_{g} < \zeta_{p} < 2\zeta_{g}$ and stable when $\zeta_{p} > 2\zeta_{g}$. There is, in this case, a limited region of instability when $\zeta_{p}$ is very small, any value below $7.58942*10^{-19}$, though this domain is biologically insignificant due to its proximity to zero. For generalists, equilibrium predator densities in these ranges are consistent with the previous case of increasing conversion efficiency. As previously described, for specialists, the absolute, and thus the relative, densities are dissimilar, given that increasing the specialist attack rate does not change how many new progeny are produced per unit of prey consumed, but the overall coexistence trends are the same. However, notably, the equilibrium density of specialist predators display slight diminishing returns as their attack rate advantage increases. These results reaffirm our $S^{*}$ analysis: a cost of generalism is required to favor specialism, with different interaction types displaying variant behaviors. In this case, regardless of how cost is modeled, it is possible to select for specialism when prey are cooperating given a minimum cost is imposed, but there is no minimum cost that can favor specialism when prey are competing. 

### **The variable outcomes of competition drive divergent selective regimes**

Our $S^{*}$ analysis next predicts that there may be some scenarios when availability of the alternative prey source (*E*) can favor the specialist even when the cost of generalism is nonexistent or extremely small. Importantly, the availability of the alternative prey source (*E*) is directly dependent on the type, strength, and coexistence outcome of prey interactions. Here, we diverge from our previous analyses focused on prey species that converge to an unbiased $1:1$ ratio at equilibrium in the absence of predations, and instead consider five additional potential scenarios at equilibrium: 1) only the shared prey source (*S*) is present, 2) both prey sources are present but the shared prey source (*S*) is more abundant, 3) both prey sources are present but the alternative prey source (*E*) is more abundant, 4) only the alternative prey source (*E*) is present, and 5) both prey species are extinct. Intuitively, all five scenarios are plausible when prey species are competing, while only scenarios 2, 4 and 5 are possible when prey species are cooperating, as both obligately mutualistic prey will be driven extinct if one member of the interdependent pair is lost. 

To verify these intuitions, we first alter the relative availability of the alternative prey source (*E*) through through $\alpha_\mathrm{j,i}$ for cooperating prey and $\beta_\mathrm{j,i}$ for competing prey. In doing so, we examine if selection for specialism - or, at minimum, predator coexistence - is possible in the absence of a cost for generalism given a biased prey ratio. Because extinction of the alternative prey source (*E*) is viable when prey are competing, we find that parameters that enable competitive exclusion mediate predator coexistence on competing prey without a cost for generalism, but the same is not true when prey are cooperating. Competitive exclusion of one prey source is possible only when both $\beta_\mathrm{i,j}$ and $\beta_\mathrm{j,i}$ values are $\ge 1.0$; otherwise, when both values are less than one, these values dictate only relative ratios. Resultantly, predator coexistence can be mediated through these values above this parametric threshold, such that whenever the alternative prey source (*E*) is competitively excluded, even without a cost of generalism, specialist and generalist predators converge to a $1:1$ ratio at equilibrium. Conversely, there is no possible equilibrium with only one prey species present when prey are cooperating; if mutualistic benefit coefficients are highly mismatched, prey species, and subsequently predator species, are driven to extinction. Changing $\alpha_\mathrm{j,i}$ and $\alpha_\mathrm{i,j}$ alone thus are not sufficient to enable predator coexistence.

We next alter the relative availability of the alternative prey source (*E*) through growth rate values $\mu_\mathrm{i}$ for both types of interactions and consider if relative growth rate is sufficient to mediate predator coexistence without a cost for generalism. In this case, when prey are competing, the growth rate of the alternative prey source (*E*) must be $\le 0.1$ and the growth rate of the shared prey source (*S*) must be $\ge 0.3$ for competitive exclusion of the alternative prey source (*E*) to occur. In this domain, both predator types converge to a $1:1$ ratio at equilibrium. When prey are cooperating, because existence of only one prey species is impossible, growth rates are again insufficient to mediate predator coexistence; the overall growth rate of the prey system is constrained by the species with lower growth rate. However, if either prey species has a growth rate $< 0.3$, the entire system, including predators, is driven to extinction, as is consistent with an Allee effect. With insufficient growth rates, the cooperative species cannot reach the densities required to support one another's reproduction. These analyses demonstrate that, without a cost of generalism, predator coexistence can be mediated by growth rate or relative competition coefficients when prey are competing - though the two parameters generate divergent patterns of coexistence - while neither growth rate nor relative benefit of mutualism are sufficient to sustain the specialist predator without a cost of generalism.

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig3.png"}
    \caption{Coexistence dynamics of predators on cooperating (right; B + D) or competing (left; A + C) prey as relative growth rates/benefit of mutualism/competition coefficients change.}
\end{figure}

Additionally, we consider the combined effect of relative availability of the alternative prey source (*E*) and cost of generalism by altering either the ratio of prey growth rates $\frac{\mu_\mathrm{i}}{\mu_\mathrm{j}}$, the ratio of competition coefficients $\frac{\beta_\mathrm{i,j}}{\beta_\mathrm{j,i}}$ or the ratio of mutualistic coefficients $\frac{\alpha_\mathrm{i,j}}{\alpha_\mathrm{j,i}}$ in combination with increasing specialist predator conversion efficiency $\gamma_\mathrm{p}$ or attack rate $\zeta_\mathrm{p}$. 

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig3_fitness.png"}
    \caption{Specialist relative fitness of predators on cooperating (right; B + D) or competing (left; A + C) prey as relative growth rates/benefit of mutualism/competition coefficients change.}
\end{figure}

Here we see considerable divergence in coexistence and dominance of the specialist predator as a function of interaction type and outcome. When prey are cooperating, all combinations of parameters follow identical patterns: neither the relative growth rates nor relative mutualistic benefit coefficients substantially alter coexistence and exclusion regimes, though the exact parameter domains change slightly. Instead, predator coexistence and dominance of the specialist predator depend almost entirely on the cost of generalism, such that if the specialist has a conversion efficiency or attack rate twice that of the generalist, the specialist will coexist with or exclude the generalist. Selective regimes on competing prey species, on the other hand, generate distinct patterns. The ratio of competition coefficients $\frac{\beta_\mathrm{i,j}}{\beta_\mathrm{j,i}}$ can enable coexistence of the specialist predator, though not extinction of the generalist predator, in those cases in which the alternative prey source (*E*) is competitively excluded and the specialist predator has a slight advantage. Comparatively, the ratio of relative growth rates $\frac{\mu_\mathrm{i}}{\mu_\mathrm{j}}$ can mediate dominance of the specialist only in the case where the shared prey (*S*) has a much faster growth rate and the alternative prey (*E*) is excluded. 

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig4.png"}
    \caption{Coexistence dynamics of predators on cooperating prey as relative growth rates/benefit of mutualism and cost of generalism change.}
\end{figure}

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig4_fitness.png"}
    \caption{Specialist relative fitness predators on cooperating prey as relative growth rates/benefit of mutualism and cost of generalism change.}
\end{figure}

Taken together, these results validate the predictions of our $S^{*}$ inequality: increasing cost of generalism and/or decreasing the relative availability of the alternative prey (*E*) will favor the specialist. Here, we see that when prey are cooperating, only an increase in the cost of generalism can select for specialism, as the obligate mutualism restricts the possible lower bound of the alternative prey (*E*). On the other hand, when prey are competing, predator coexistence (though not full extinction of the generalist predator) can be mediated entirely through the outcome of competition, without a cost of generalism, given the potential for competitive exclusion of the alternative prey (*E*). 

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig5.png"}
    \caption{Coexistence dynamics of predators on cooperating prey as relative growth rates/competition coefficients and cost of generalism change.}
\end{figure}

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig5_fitness.png"}
    \caption{Specialist relative fitness predators on competing prey as relative growth rates/competition coefficients and cost of generalism change.}
\end{figure}

### **Generalist preference can reduce predator niche overlap and increase the range of coexistence**

To this point, we have considered a system in which the generalist predator has an equivalent conversion efficiency and attack rate on each prey species. However, in natural systems, there is likely to be a quality difference between prey species, such that a generalist predator has a higher conversion efficiency or attack rate on one than another. We explore this possibility by examining three potential scenarios: a) the ratio of generalist conversion efficiency/attack rate on each prey is biased but sums to less than the specialist's conversion efficiency/attack rate, b) the ratio of generalist conversion efficiency/attack rate on each prey is biased but sums to the equivalent of the specialist's conversion efficiency/attack rate, or c) the ratio of generalist conversion efficiency/attack rate on each prey is biased and sums to a value greater than the specialist's conversion efficiency/attack rate. Of these scenarios, b) and c) represent situations in which the only potential cost of generalism is the opportunity cost of time and energy wasted pursuing less valuable prey. 

When generalist preference is modeled as conversion efficiency, any biased ratio for the generalist that sums to greater than that of the specialist's conversion efficiency results in exclusion of the specialist regardless of prey interaction. This is unsurprising as it amounts to a benefit of generalism, rather than a cost. There is a small region of predator extinction on cooperating prey when generalist conversion efficiency is sufficiently high, as the growth rates of the prey cannot sustain the level of predation and the system collapses. When the conversion efficiencies of the generalist on each prey species sum to the equivalent of the specialist's conversion efficiency, coexistence of the two predators is possible, although the generalist dominates. Finally, in the region where the sum of the conversion efficiencies of the generalist are less than that of the specialist, a generalist preference for the alternative prey source (*E*) can enable coexistence of the generalist on either type of interacting prey species. On cooperating prey, the preference for the alternative prey source (*E*) must be $\ge 10$, with a larger bias toward the alternative prey source (*E*) reducing the conversion efficiency required on the shared prey source (*S*) to enable coexistence. A similar pattern can be seen when prey species are competing, although the generalist predator can coexist more easily over a wider range of relative conversion efficiencies. 

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig6.png"}
    \caption{Impact of generalist preference on predator coexistence when prey are cooperating (left; A + C) or competing (right; B + D).}
\end{figure}

Results diverge when cost is modeled as attack rate. Here, biasing the attack rate of the generalist predator toward the alternative prey source (*E*) in fact reduces its fitness and increases the parameter space where the specialist can coexist, even when the generalist ostensibly has a benefit, rather than a cost. These patterns are the result of the fact that increasing attack rate does not fundamentally change the number of predators produced, but instead changes the speed with which they reproduce. In these cases, as the generalist reduces the density of the alternative prey source (*E*) more and more quickly, the specialist predator dominates by making better use of the shared prey source (*S*). This is reflected in the fact that a biased attack rate when prey are competing significantly increases the range of coexistence for the specialist compared to when prey are cooperating, given the possibility for competitive release when the generalist rapidly suppresses that alternative prey source (*E*).

These results suggest that increasing attack rate has a diminishing return for predators, particularly when prey species are competing. Additionally, they show that the opportunity cost of generalist preference is high only when the niche overlap between the two predators is high; that is, a preference for the alternative prey source (*E*) is more beneficial for the generalist than a preference for the shared prey source (*S*) regardless of the interactions between prey or the type of cost imposed. 

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig6_fitness.png"}
    \caption{Impact of generalist preference on predator relative fitness when prey are cooperating (left; A + C) or competing (right; B + D).}
\end{figure}

### **Increasing nutrient availability favors generalism when prey compete**

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig7.png"}
    \caption{Normalized equilibrium abundances of all four species as carrying capacity changes, with cooperating prey on the left (A) and competing prey on the right (B).}
\end{figure}

Lastly, given the empirically demonstrated importance of nutrient availability in selecting for generalist diet breadth at higher trophic levels, we increase the carrying capacity of our modeled Lotka-Volterra system to examine predator coexistence with and without a cost of generalism. We do so by varying the value *R* between 0 and 5. Here we see that the carrying capacity can have a substantially different impact on interaction types. As *R* increases when prey are cooperating, there is a narrow range of carrying capacities at which the population can be maintained, such that all species will go extinct unless $1 \le R \le 2.2$. This range is determined by the Monod constants $\kappa_\mathrm{i}$ and $\kappa_\mathrm{j}$. Increasing these values decreases the range of carrying capacities that can support cooperating prey by decreasing the shared mutualistic benefit and increasing the impact of intraspecific competition, while decreasing these values increases the range of carrying capacities that can support cooperating prey. In comparison, a system with competing prey can be sustained at any $R > 0$, although the prey density is not sufficient to support predator growth until $R > 1.5$. In both interaction cases, without a cost of generalism, only the generalist predator is able to reproduce across these carrying capacity ranges.

When a fitness cost of generalism is imposed over a range of carrying capacities, $0 \le R \le 5$ when prey are competing and $0 \le R \le 2.5$ when prey are cooperating, regions of exclusion by the specialist predator are limited. When prey compete, coexistence between the two predators, with the generalist dominating, occurs in any system where $R > 1.6$, even when the specialist has an advantageous conversion efficiency or attack rate. This is consistent with previous experimental findings that increasing nutrient availability can select for herbivore generalism. Comparatively, when prey are cooperating, if the specialist has an advantage at least twice the conversion efficiency or attack rate of the generalist, an $1 \le R \le 1.5$ is generally sufficient for the specialist predator to dominate. When $1.5 \le R \le 2.2$, a larger cost of generalism is required to favor the specialist. Decreasing the Monod constants, and subsequently increasing the range of viable carrying capacities for the system, do not change these qualitative results. These results suggest that increasing nutrient availability in a system can advantage generalists at higher trophic levels, but that the favorability of generalism is tempered if the generalist predator is selected on cooperating prey as opposed to competing prey.

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig8.png"}
    \caption{Impact of carrying capacity on predator coexistence when prey are cooperating (left; A + C) or competing (right; B + D).}
\end{figure}

\begin{figure}
   \includegraphics[width=0.75\textwidth]{"/Users/abisesi/Desktop/PhD/Projects/Host-Ecology-and-Host-Range/Paper/images/fig8_fitness.png"}
    \caption{Impact of carrying capacity on predator relative fitness when prey are cooperating (left; A + C) or competing (right; B + D).}
\end{figure}

## Discussion

Why should predators specialize when the benefits of generalism are numerous? Trade-off theory provides the most oft-cited reason: expanded prey range is limited by evolutionary trade-offs and antagonistic pleiotropy. Additional empirical and theoretical work, based on optimal foraging theory, suggests that the structure of prey communities plays a significant role in shaping selection on predator diet breadth by altering prey absolute and relative abundance, spatial distribution, prey quality, and alpha diversity. Because interspecific interactions between prey dictate many aspects of prey community structure, the sign and outcome of interactions between prey may be important to determining selective regimes on predators even when there is no cost of generalism observed.

However, optimal foraging theory and trade-off theory are not mutually exclusive, and indeed likely work together in shaping predator evolution in a diversity of complex communities. Here, we have sought to integrate hypotheses from both frameworks to elucidate how interactions between prey and constraints inherent to prey biology drive diet breadth shifts. Our results illustrate that a simple rule can be used to predict the direction of selection when prey are engaged in different types of interactions, such that specialism will be favored when the cost of generalism is sufficiently high or the availability alternative prey source used only by the generalist is sufficiently low. This rule subsequently shows that specialism will be selected on obligately mutualistic prey given a minimum cost of generalism because the interdependence of the prey interactions precludes a significant reduction in the alternative prey source. It also demonstrates that it is easier to select for generalism on competing prey, even given with a cost, if the shared prey source can be competitively excluded.

Importantly, the variable outcomes of competition can significantly shift predictions of selective regimes on predator diet breadth. In our model, we show that, without a cost of generalism, coexistence between predator genotypes is possible only by changing the relative abundances of prey through competition coefficients or growth rates. Competitive exclusion of the alternative prey source can be sufficient to select for specialism given the most minimal of costs. In comparison, obligately mutualistic interactions do not have the same range of variable outcomes as competition, and we show that, as a result, it is significantly more difficult to avoid extinction of the entire system. This is true even as nutrient availability is increased, given the saturating effect of many obligate mutualisms. 

Lastly, we show that cost of generalism can be modeled and understood as a prey quality difference. When niche overlap between the two predators is high, this cost is exaggerated; when it is low, the effect is tempered. This reinforces the benefit of predator specialization, and provides context for situations in which it might occur: moving toward biased or sole exploitation of the alternative prey source can quickly improve the fitness of a genotype with a novel prey range, even when there is a difference in quality between prey sources. However, our results also demonstrate that this cost of generalism broadly matches the qualitative predictions of our simple rule, such that there is much more parameter space favoring specialism when prey are cooperating and more parameter space favoring generalism when prey are competing. 

Predicting evolutionary shifts in predator diet breadth has a myriad of applications in medicine, agriculture, conservation and public health, especially in the management of microbial communities ranging from the human gut microbiome to antibiotic resistant bacterial infections. Our modeling suggests that understanding diet breadth requires an understanding of the interspecific interactions occurring in the broader community, particularly those interactions determining the presence and abundance of prey species. These predictions can be tested using system-specific modelling and experimental research on established microbial systems capable of both competition and obligate interactions [Harcombe 2010]. Understanding the variable outcomes of competition in selecting for different diet breadths may be especially relevant for preventing pathogen or herbivore range-shifts in agriculture, where agricultural plants often have considerable resource-use overlap. Notably, though true obligate mutualisms are infrequent outside the microbial world, our results reflect the necessity of additional investigation into the interplay between predation and mutualistic prey. Additionally, our theoretical results could be expanded to more complex systems, involving *n* prey and/or predator species, to investigate their application as community diversity increases and the degree of generality changes (i.e. generalists that can infect most, but not all, of the species present). Our model is also sufficiently simplistic that it can be repurposed to the biological specifics of any predator-prey, plant-herbivore, host-pathogen system to generate targeted predictions of resource utilization shifts. Finally, we expect that extension of our model into spatially structured environments, where species distributions are driven predominantly by the sign and outcome of interactions between prey, will yield qualitatively different results and provide a fruitful future direction for contextualizing the role of prey interactions in shaping predator diet breadth.  

## References







